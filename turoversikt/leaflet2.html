

<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Leaflet test</title>

    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.0.6/dist/MarkerCluster.css" />
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet' />
    <link rel="stylesheet" type="text/css" href="test.css" />

</head>

<body class="kindergarden-find-page">


    <div class="container">
        <header>
            <h1>Leaflet test</h1>
            <nav>
                <ul>
                    <li>
                        <a href="leaflet.html">Linjer, alle vist</a>
                    </li>
                    <li class="active">
                        <a href="leaflet2.html">Fylt område</a>
                    </li>
                    <li>
                        <a href="leaflet3.html">Markør, linje ved hover</a>
                    </li>
                    <li>
                        <a href="leaflet4.html">Grupperte markører, linje ved klikk</a>
                    </li>
                </ul>
            </nav>
            <p>Kommentar fra Thomas: Dette kan bli ganske bra, men vi har i dagens datagrunnlag ingen "polygon" vi kan bruke for å tegne former, så disse som vises har jeg laget for hånd. Dette er nok noe Roy+co kan levere om vi vil vise som dette.</p></o>
        </header>

        <div id="leaflet-map" class="map"></div>
    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <script type="text/javascript" src="https://unpkg.com/leaflet.markercluster@1.0.6/dist/leaflet.markercluster.js"></script>
    <script type="text/javascript" src="https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js"></script>
    <script type="text/javascript" src="https://tsadm.webatlas.no/sh/leafletplugins/L.TileLayer.Webatlas/v1.0.0/L.TileLayer.Webatlas.min.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.min.js"></script>

    <script>

        var map;
        var bounds = new L.latLngBounds();
        var coordsArray = [];
        var routeLayers = [];

        function initializeMap(container, latitude, longitude, zoom) {
            // Create a map
            var map = L.map(
                container,
                { 
                    dragging: !L.Browser.mobile,
                    tap: !L.Browser.mobile,
                    fullscreenControl: true
                }
            ).setView([latitude, longitude], zoom);

            // Peanuts demo API key from Arild Nomeland
            var apiKey = '07C4A129-9D26-4B3D-9BC8-B22E4B6E509E';

            var baseLayers = {
                'Kart': L.tileLayer.webatlas({
                    mapType: L.TileLayer.Webatlas.Type.VECTOR,
                    apikey: apiKey
                }).addTo(map),
                'Foto': L.tileLayer.webatlas({
                    mapType: L.TileLayer.Webatlas.Type.AERIAL,
                    apikey: apiKey
                }),
                'Hybrid': L.tileLayer.webatlas({
                    mapType: L.TileLayer.Webatlas.Type.HYBRID,
                    apikey: apiKey
                })
            };
            L.control.layers(baseLayers).addTo(map);
            return map;
        }
        function cropMap() {
            map.fitBounds(bounds);
        }
        function addRoute(map, no) {

            $.getJSON( "trips/" + no + ".poly.json", function( data ) {
                var layer = L.geoJSON(data,
                {
                    style:
                    {
                        weight: 1, 
                        color: "black", 
                        opacity: 1,
                        fillColor: "#005692",
                        fillOpacity: 0.5
                    }
                }).addTo(map);
                layer.on("mouseover", function(e) {
                    this.setStyle({fillOpacity: 1});
                });
                layer.on("mouseout", function(e) {
                    this.setStyle({fillOpacity: 0.5});
                });
                bounds.extend(layer.getBounds())
            });
        }

        map = initializeMap("leaflet-map", 58.94, 5.74, 10);

        for (i = 0; i < 7; i++) { 
            addRoute(map, i+1);
        }
        addRoute(map, 9);
        addRoute(map, 31);

        setTimeout(function() {cropMap()}, 1000);
        map.on('fullscreenchange', function () {
            setTimeout(function() {cropMap()}, 100);
        });

    </script>

</body>
</html>